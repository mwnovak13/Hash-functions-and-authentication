#include <stdio.h>
#include <string.h>
#include <stdint.h>

#include "aes_d.h"


void readCipherText(uint8_t *);
void writeCipherText(uint8_t *);


int main(void)
{
     
    
    uint8_t in[]  = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
    
    readCipherText(in);
    
    struct AES_ctx ctx;
    AES_decrypt(&ctx, in);    
    
    printf("Exploit of the back door in Acme Corporation's AES Encryption\n");
    printf("Decryption is complete.\n");
    printf("The plaintext is: ");
    printf("%s",in);
    printf("\n");
    return 0;
}





void readCipherText(uint8_t * ctxt) {
    FILE *fp;
    fp = fopen("ciphertext.dat", "rb");

    fread(ctxt, 16, 1, fp);
  
    fclose(fp);
}


void writeCipherText(uint8_t * ctxt) {
    FILE *fp;
    fp = fopen("ciphertext.dat", "wb");

    fwrite(ctxt, 16, 1, fp);
  
    fclose(fp);
}
